(int, int, int, int) ecrecover (int hash, int v, int r, int s) asm "ECRECOVER NULLSWAPIFNOT2 NULLSWAPIFNOT";

int check_secp256k1_signature(int test_hash, slice data, int public_key) {

	int v = data~load_uint(8);
	int r = data~load_uint(256);
	int s = data~load_uint(256);

	var (h, x1, x2, status) = ecrecover(test_hash, v, r, s);

	return (x1 == public_key);
}
